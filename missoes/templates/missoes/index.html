{% extends "SiGeCAV/base.html" %}

{% block title %}SiGeCAV - Missões{% endblock %}

{% block header %}Missões{% endblock %}

{% block content %}
  {% load staticfiles %}

  <a class="btn btn-default" href="{% url 'acidentes' %}"><img src="{% static 'images/back.png' %}" /></a>

  <table class="table">
    <tr>
      <th>Nome</th>
      <th>Tipo</th>
      <th>Status</th>
      <th>Recursos alocados</th>
      <th></th>
    </tr>
    {% for missao in missoes %}
      <tr>
        <td>{{missao.nome}}</td>
        <td>{{missao.get_tipoMissao_display}}</td>
        <td>{{missao.get_status_display}}</td>
        {% if missao.recursos.count == 0 %}
          <td> 0 </td>
        {% else %}
          <td><a href="/acidentes/missoes/detalhes?id={{missao.id}}">{{missao.recursos.count}}</a></td>
        {% endif %}

        <td class="btn-group btn-group-sm">
          <a class="btn btn-default" href="/acidentes/missoes/detalhes?id={{missao.id}}">detalhar</a>
          


        {% if user.profile.tipoAcesso == 'coordenador' %}
          <a class="btn btn-default" href="/acidentes/missoes/alocarRecurso?acidente_id={{acidente.id}}&missao_id={{missao.id}}">alocar recurso</a>
          <a class="btn btn-default" href="/acidentes/missoes/alterarStatus?id={{missao.id}}">alterar status</a>
        {% endif %}          

        {% if user.profile.tipoAcesso == 'administrador' %}
          <a class="btn btn-default" href="/acidentes/missoes/remover?id={{missao.id}}" onclick="return confirm('Tem certeza de que deseja remover a missão?');">remover</a>
        {% endif %}

        </td>
      </tr>
    {%endfor%}
  </table>

  {% if user.profile.tipoAcesso == 'especialista' %}
    <a class="btn btn-default" href="/acidentes/missoes/novo?acidente_id={{acidente.id}}">Cadastrar missao</a>
  {% endif %}
{% endblock %}
